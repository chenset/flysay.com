<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <title>Fly Say</title>
    <meta charset="UTF-8"/>
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
    <link rel="canonical" href="https://flysay.com"/>
    <link rel="icon" href="/favicon.ico" type="image/x-icon">
    <link rel="shortcut icon" href="/favicon.ico" type="image/x-icon">
    <style>
        * {
            padding: 0;
            margin: 0;
            -webkit-box-sizing: border-box;
        }

        body {
            font-family: Helvetica, Arial, sans-serif, "Microsoft YaHei", 'Helvetica Neue';
            color: #333;
            font-size: 14px;
        }

        *:focus {
            outline: none;
        }

        ::selection {
            background: #efefef;
        }

        a {
            color: #000;
            text-decoration: none;
        }

        h1, h2, h3, h4, h5, h6 {
            font-weight: 400;
            margin: 15px 0;
        }

        input {
            -webkit-appearance: none;
            border-radius: 0;
        }

        a:hover, a:focus {
            color: #444;
        }

        li {
            list-style: none;
        }


        .main-wrap {
            width: 100%;
            padding: 0 30px;
            position: absolute;
            top: 50%;
            margin-top: -90px;
            text-align: center;
            z-index: 2;
        }

        .main-header {
            display: inline-block;
            text-align: left;
            margin-left: auto;
            margin-right: auto;
            background: #FFF;
            padding: 2px 20px 10px;
            opacity: 0.9;
        }

        .site-menu {
            border-top: 1px solid #f1f1f1;
        }

        .site-menu li {
            float: left;
            line-height: 14px;
            font-size: 14px;
            padding: 10px 40px 10px 0;
        }

        .site-menu li:last-child {
            padding-right: 0;
        }

        @keyframes fadein {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }
    </style>
</head>
<body>
<div class="main-wrap">
    <header class="main-header">
        <div class="container">
            <div style="font-size:14px;color: #ff5252;padding:5px 10px;float: right;cursor: pointer;animation: fadein 2s"
                 id="switch">+
            </div>
            <h2 class="main-logo-wrap">
                <a id="main-logo" href="/">
                    <span style="color:#ff5252">F</span><span style="color:#cc9966">l</span><span
                        style="color:#41B883">y</span> <span style="color:#01AAED">S</span><span
                        style="color:#cc9966">a</span><span style="color:#41B883">y</span>
                </a>
            </h2>
            <nav class="site-menu">
                <ul>
                    <li><a href="https://blog.flysay.com/">BLOG</a></li>
                    <li><a href="https://str.flysay.com/">字幕文件重命名</a></li>
                    <li><a href="https://har2jmx.flysay.com/">HAR2JMX</a></li>
                    <li><a href="https://sensor.flysay.com/">SENSOR</a></li>
                    <li><a href="https://asuka.flysay.com/">ASUKA</a></li>
                    <li><a href="https://github.com/chenset">GITHUB</a></li>
                </ul>
            </nav>
        </div>
    </header>
</div>

<div style="height:100%;width:100%;position: absolute;z-index: 1;overflow: hidden;display:none;animation: fadein 2s;"
     id="img-wrap">
    <img id="img-el"
         style="max-width: 100%;min-width:1400px;height:auto;display: block;margin: 0 auto;position: relative;"/>
</div>
<footer id="exif-wrap"
        style="position: fixed;bottom: 0;left:0;z-index: 2;background: #FFF; opacity: 0.8;padding:2px 6px;font-size: 10px;display: none;animation: fadein 2s;">
    <span id="exif-date"></span>
    <a style="margin-left: 6px" target="_blank" id="exif-google-map">Map</a>
</footer>
<script>
    let flag = false, resizeTimer, xhr = new XMLHttpRequest(), imagePath, imgStorage = [
        'https://h.flysay.com/',
        'https://pages.flysay.com/',
        'https://img.flysay.com/',
        '/',
    ], img = document.getElementById("img-el");

    function start() {
        let script = document.createElement('script');
        script.onload = function () {
            xhr.onreadystatechange = function () {
                if (this.readyState === 4 && this.status === 200) {
                    try {
                        let items = JSON.parse(this.responseText);
                        imagePath = items[Math.floor(Math.random() * items.length)].path;
                        loadImg();
                        img.addEventListener('error', loadImg);
                    } catch (e) {
                    }
                }
            };
            xhr.open("GET", "https://api.github.com/repositories/186582306/contents/images", true);
            xhr.setRequestHeader("Authorization", "token" + " 12a1f8bf43883b5db6ca562" + "2c046f516" + "0d5dc7e6"); // + for hack
            xhr.send();
        };
        script.src = "/exif.js";
        document.getElementsByTagName('head')[0].appendChild(script);
    }

    document.getElementById('switch').addEventListener('click', function () {
        if (flag) {
            document.getElementsByClassName('main-wrap')[0].style.display = 'none';
        } else {
            start();
        }
        this.style.transform = 'rotate(45deg)';
        flag = true;
    });

    window.addEventListener('resize', function () {
        clearTimeout(resizeTimer);
        setTimeout(function () {
            imgPosition();
        }, 100);
    });


    img.addEventListener('load', function () {
        document.getElementById('img-wrap').style.display = 'block';
        imgPosition();
        EXIF.getData(img, function () {
            let info = EXIF.getAllTags(this);
            if (info.hasOwnProperty('GPSLatitude') && info.GPSLatitude.length) {
                document.getElementById('exif-wrap').style.display = 'block';
                let latitude = (info.GPSLatitude[0] + info.GPSLatitude[1] / 60 + info.GPSLatitude[2] / 3600).toFixed(7),
                    longitude = (info.GPSLongitude[0] + info.GPSLongitude[1] / 60 + info.GPSLongitude[2] / 3600).toFixed(7);
                document.getElementById('exif-date').innerText = info.DateTime;
                document.getElementById('exif-google-map').href = "https://maps.google.com/?q=" + latitude + "," + longitude + "&ll=" + latitude + "," + longitude + "&z=18";
            }
        });
    });

    function loadImg() {
        if (imgStorage.length) {
            img.src = imgStorage.shift() + imagePath;
        }
    }

    function imgPosition() {
        if (img.clientWidth > window.innerWidth) {
            img.style.left = (-(img.clientWidth - window.innerWidth) / 2) + "px";
        } else {
            img.style.left = "0";
        }
        img.style.top = (-(img.clientHeight - window.innerHeight) / 2) + "px";
    }
</script>
</body>
</html>
